<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" type="text/css" href="./styles/styles.css" />
</head>
</head>

<body>
    <canvas id="canvas">
    </canvas>
</body>
<script>

    let idol1 = new Image();
    let idol2 = new Image();
    let idol3 = new Image();
    let idol4 = new Image();
    let idol5 = new Image();
    let idol6 = new Image();
    let idol7 = new Image();
    let idol8 = new Image();
    let idol9 = new Image();
    function init(){
        idol1.src = 'img/img2.gif';
        idol2.src = 'img/img1.jpg';
        idol3.src = 'img/img3.jpg';
        idol4.src = 'img/img4.jpg';
        idol5.src = 'img/img5.jpg';
        idol6.src = 'img/img6.jpg';
        idol7.src = 'img/img7.jpg';
        idol8.src = 'img/img8.jpg';
        idol9.src = 'img/img9.jpg';
        window.requestAnimationFrame(draw);
    }
    // var canvas = document.getElementById('viewport'),
    // context = canvas.getContext('2d');

    // canvas.width = window.innerWidth;
    // canvas.height = window.innerHeight;
    // make_base();

    // function make_base()
    // {
    // base_image = new Image();
    // base_image.src = 'img/img2.gif';
    // base_image.onload = function(){
    //     context.drawImage(base_image, 0, 0);
    // }
    // }

    //number of images
    let idols_picts = [idol1,idol2,idol3,idol4,idol5,idol6,idol7,idol8,idol9];
    //let idols_picts = [idol1];
    let num_of_picts = idols_picts.length;

    //array define time to spaw picts
    let time_to_spaw_pict = [];
    for (let x = 0; x < num_of_picts; x++) {
        let div_canvas = (((window.innerWidth + 100) / 2)/num_of_picts);
        if (x === 0) {
            time_to_spaw_pict.push(0);
        }
        else{
            time_to_spaw_pict.push(time_to_spaw_pict[x-1]+div_canvas);
        }
        
    }
    console.log(time_to_spaw_pict);

    //array estado activacion label
    let array_status_layer = 0;
    // for (let x = 0; x < num_of_picts; x++) {
    //     array_status_layer.push(0);
    // }


    //incrementador espaciado desde el centro - loop
    let inc2 = 1;
    let array_increment_pos = [];
    for (let x = 0; x < num_of_picts; x++) {
        array_increment_pos.push(0);
    }

    //incrementador tamaño imagenes
    let inc3 = 0.5;
    let array_size_pict = [];
    for (let x = 0; x < num_of_picts; x++) {
        array_size_pict.push(0);
    }

    function draw() {
        var canvas = document.getElementById('canvas');
        var ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        ///ctx.globalCompositeOperation = 'destination-over';
        ctx.clearRect(0,0,window.innerWidth,window.innerHeight); // limpiar canvas

        // ctx.fillStyle = 'rgba(0,0,0,0.4)';
        // ctx.strokeStyle = 'rgba(0,153,255,0.4)';
        ctx.save();
        ctx.translate(window.innerWidth /2 ,innerHeight/2);

        var maxCircle = 20;
        var radius = 300;
        var size = 100;
        

        //LAYER 1
        for (let n=0; n<num_of_picts;n++){
            if((array_increment_pos[0]>=time_to_spaw_pict[n])&& array_status_layer === 0)
            {
                if (n === (num_of_picts -1)){
                    array_status_layer=1;
                    console.log("reached last layer, interval between layers set!");
                }
                
                array_increment_pos[n] = array_increment_pos[n] + inc2;
                array_size_pict[n]= array_size_pict[n] + inc3;
                if (array_increment_pos[n] > ((window.innerWidth + 100) / 2)) {
                    array_increment_pos[n]  = 0;
                    array_size_pict[n]  = 0;
                }
                for (var i=1; i <=maxCircle; i++){
                    ctx.drawImage(idols_picts[n],array_increment_pos[n],0,array_size_pict[n],array_size_pict[n]);
                    ctx.beginPath();
                    ctx.arc(0,radius,size,0,2*Math.PI,false);
                    ctx.rotate(2*Math.PI/maxCircle);
                    //ctx.fill();
                }
                
            }
            else if(array_status_layer === 1) {
                //console.log("entro al else");
                array_status_layer[n]=1;
                array_increment_pos[n] = array_increment_pos[n] + inc2;
                array_size_pict[n]= array_size_pict[n] + inc3;
                if (array_increment_pos[n] > ((window.innerWidth + 100) / 2)) {
                    array_increment_pos[n]  = 0;
                    array_size_pict[n]  = 0;
                }
                for (var i=1; i <=maxCircle; i++){
                    ctx.drawImage(idols_picts[n],array_increment_pos[n],0,array_size_pict[n],array_size_pict[n]);
                    ctx.beginPath();
                    ctx.arc(0,radius,size,0,2*Math.PI,false);
                    ctx.rotate(2*Math.PI/maxCircle);
                    //ctx.fill();
                }
            }

        }



        //layer 2
        // if (incr_total2 > 300)
        // {
        //     for (var i=1; i <=maxCircle; i++){
        //     ctx.drawImage(idol2,incr_total2,0,incr_total3,incr_total3);
        //     ctx.beginPath();
        //     ctx.arc(0,radius,size,0,2*Math.PI,false);
        //     ctx.rotate(2*Math.PI/maxCircle);
        //     //ctx.fill();
        // }
        
        // }


        // La tierra
        var time = new Date();
        let rot_speed = 2;
        var rad = Math.PI/180;
        var angulo = 5;
        //console.log(time.getSeconds());
        //ctx.rotate(rad * angulo);
        //ctx.rotate( ((rot_speed*Math.PI)/60)*time.getSeconds() + ((rot_speed*Math.PI)/60000)*time.getMilliseconds() );
        //ctx.translate(incr_total,0);
        //incr_total = incr_total + incr;
        //ctx.fillRect(0,-12,50,24); // Sombra
        //ctx.drawImage(idol1,0,0);

        //   // La luna
        //   ctx.save();
        //   ctx.rotate( ((2*Math.PI)/6)*time.getSeconds() + ((2*Math.PI)/6000)*time.getMilliseconds() );
        //   ctx.translate(0,28.5);
        //   ctx.drawImage(moon,-3.5,-3.5);
        //   ctx.restore();

        // ctx.restore();
        
        // ctx.beginPath();
        // ctx.arc(150,150,105,0,Math.PI*2,false); // Órbita terrestre
        // ctx.stroke();
        
        //ctx.drawImage(sun,0,0,300,300);

        window.requestAnimationFrame(draw);
    }

    init();
</script>

</html>